# ç½‘ç»œæ”»å‡»æ£€æµ‹å·¥ä½œæµ

åŸºäºæ™ºèƒ½ä½“å¹³å°çš„ç½‘ç»œæ”»å‡»æ£€æµ‹ç³»ç»Ÿï¼Œé€šè¿‡å¾ªç¯ä½“æ¶æ„å®ç°æŠ¥æ–‡æ‰¹é‡å¤„ç†å’Œä¸Šä¸‹æ–‡çŠ¶æ€ä¿æŒï¼Œæ”¯æŒå¤šç§æ”»å‡»ç±»å‹æ£€æµ‹å’ŒLLMæ·±åº¦åˆ†æã€‚

## ğŸ¯ ç³»ç»Ÿç‰¹ç‚¹

- **å¼ºå¤§è§„åˆ™å¼•æ“**: æ”¯æŒ12+ç§ä¸»è¦æ”»å‡»ç±»å‹æ£€æµ‹
- **æ™ºèƒ½LLMåˆ†æ**: é«˜é£é™©æŠ¥æ–‡è‡ªåŠ¨è¿›å…¥LLMæ·±åº¦åˆ†æ
- **ä¸Šä¸‹æ–‡æ„ŸçŸ¥**: åŸºäºå†å²è¡Œä¸ºçš„æ™ºèƒ½å…³è”åˆ†æ
- **å¾ªç¯ä½“æ¶æ„**: å®Œç¾é€‚é…æ™ºèƒ½ä½“å¹³å°é™åˆ¶
- **æ— å¤–éƒ¨ä¾èµ–**: æ‰€æœ‰ä»£ç å†…åµŒï¼Œæ— éœ€é¢å¤–åŒ…æ–‡ä»¶

## ğŸ—ï¸ å·¥ä½œæµç¨‹
```
å¼€å§‹èŠ‚ç‚¹A: ç”¨æˆ·ä¼ å…¥è¯·æ±‚æŠ¥æ–‡æ–‡æœ¬(user_inputï¼Œæ³¨æ„ï¼šä¸ºå¤šè¡Œå­—ç¬¦ä¸²ï¼Œæ¯è¡Œä¸€æ¡æŠ¥æ–‡)
    â†“
å¾ªç¯ä½“B: å¤„ç†æ¯ä¸ªæŠ¥æ–‡ï¼Œç»´æŠ¤è¾…åŠ©å†³ç­–å˜é‡
    â”œâ”€ BA: å•ä¸ªæŠ¥æ–‡æå–æ¨¡å—
    â”œâ”€ BB: è¾…åŠ©å†³ç­–ä¿¡æ¯æå–æ¨¡å—  
    â”œâ”€ BC: å¾ªç¯å˜é‡æ›´æ–°æ¨¡å—
    â”œâ”€ BD: å†³ç­–å¼•æ“
    â”œâ”€ BE: é£é™©è¯„åˆ†åˆ¤æ–­(â‰¤50ç›´æ¥è¾“å‡ºï¼Œ>50è¿›å…¥LLM)
    â”œâ”€ BF: å“åº”ç”Ÿæˆå™¨(ç›´æ¥è¾“å‡ºåˆ†æ”¯)
    â”œâ”€ BG: LLMæ”»å‡»åˆ†æï¼ˆLLMèŠ‚ç‚¹ï¼Œå°è£…ï¼Œä¸å¯é€šè¿‡Pythonè°ƒç”¨ï¼‰
    â”œâ”€ BH: å…¨é‡ç»“æœæ›´æ–°æ¨¡å—
    â””â”€ BI: å¾ªç¯å˜é‡æ›´æ–°æ¨¡å—
    â†“
è¾“å‡ºå…¨éƒ¨å“åº”ç»“æœ(all_detect_results)
```

## ğŸ“¦ é¡¹ç›®ç»“æ„
```
network_security_agent/
â”œâ”€â”€ modules/                           # Pythonä»£ç æ‰§è¡Œæ¨¡å—
â”‚   â”œâ”€â”€ message_extractor.py          # å•ä¸ªæŠ¥æ–‡æå–æ¨¡å— (BA)
â”‚   â”œâ”€â”€ context_extractor.py          # è¾…åŠ©å†³ç­–ä¿¡æ¯æå–æ¨¡å— (BB)
â”‚   â”œâ”€â”€ decision_engine.py            # å†³ç­–å¼•æ“æ¨¡å— (BD)
â”‚   â”œâ”€â”€ response_generator.py         # å“åº”ç”Ÿæˆå™¨æ¨¡å— (BF)
â”‚   â””â”€â”€ result_updater.py             # å…¨é‡ç»“æœæ›´æ–°æ¨¡å— (BH)
â”œâ”€â”€ prompts/                          # LLMæç¤ºè¯æ–‡æœ¬æ–‡ä»¶ï¼ˆSystem/Useræ¨¡æ¿ï¼‰
â”‚   â”œâ”€â”€ llm_security_analysis.txt     # å®‰å…¨åˆ†ææç¤ºè¯
â”‚   â”œâ”€â”€ llm_threat_intelligence.txt   # å¨èƒæƒ…æŠ¥åˆ†ææç¤ºè¯
â”‚   â””â”€â”€ llm_false_positive_analysis.txt # è¯¯æŠ¥åˆ†ææç¤ºè¯
â”œâ”€â”€ test_cases/                       # æµ‹è¯•æ¡ˆä¾‹
â”‚   â”œâ”€â”€ normal_requests.json
â”‚   â”œâ”€â”€ sql_injection_attacks.json
â”‚   â”œâ”€â”€ xss_attacks.json
â”‚   â”œâ”€â”€ command_injection_attacks.json
â”‚   â”œâ”€â”€ path_traversal_attacks.json
â”‚   â”œâ”€â”€ advanced_attacks.json
â”‚   â””â”€â”€ mixed_attacks.json
â””â”€â”€ FORMAT_GUIDE.md                   # æ¨¡å—æ ¼å¼æŒ‡å—
```

## ğŸ¤– LLMé›†æˆä¸å˜é‡ç»‘å®šï¼ˆå°è£…LLMï¼‰

å¹³å°çš„LLMæ¨¡å—ä¸ºå°è£…èŠ‚ç‚¹ï¼Œåªå…è®¸è®¾ç½®Systemæç¤ºè¯ä¸Useræç¤ºè¯ã€‚æç¤ºè¯ä¸­å…è®¸ä½¿ç”¨`{å˜é‡å}`å ä½ç¬¦ï¼Œè¿™äº›å˜é‡å¿…é¡»æ¥æºäºå…¨å±€ï¼ˆå³èŠ‚ç‚¹è¾“å…¥/è¾“å‡ºï¼‰ã€‚æœ¬é¡¹ç›®å»ºè®®å¹¶å·²åœ¨æç¤ºè¯ä¸­ä½¿ç”¨å¦‚ä¸‹å…¨å±€å˜é‡ï¼š

- `{message}`: å½“å‰æŠ¥æ–‡æ–‡æœ¬ï¼ˆæ¥è‡ª BA è¾“å‡ºçš„ `message_data` è§£æåçš„`message`ï¼‰
- `{messages_infos}`: å†å²ä¸ä¸Šä¸‹æ–‡ç»Ÿè®¡ï¼ˆæ¥è‡ª BB è¾“å‡ºï¼‰
- `{decision_result}`: è§„åˆ™å¼•æ“è¾“å‡ºï¼ˆæ¥è‡ª BD è¾“å‡ºï¼‰

> æ³¨æ„ï¼šå ä½ç¬¦æ›¿æ¢ç”±å¹³å°å®Œæˆã€‚è¯·åœ¨å·¥ä½œæµè¿çº¿é…ç½®ä¸­å°†å¯¹åº”å˜é‡æ˜ å°„åˆ°LLMèŠ‚ç‚¹çš„System/Useræç¤ºè¯ã€‚

### LLMèŠ‚ç‚¹æ¥å…¥ç¤ºä¾‹
- System: ç›´æ¥ç²˜è´´ `prompts/llm_security_analysis.txt`ï¼ˆæˆ–å…¶ä»–ï¼‰ä½œä¸ºSystemæç¤ºè¯
- User: ä½¿ç”¨åŒæ–‡ä»¶å°¾éƒ¨ `[User]` æ®µå†…å®¹ä½œä¸ºUseræç¤ºè¯
- å˜é‡æ˜ å°„ï¼š
  - `message` â† `message_extractor.message_data.message`
  - `messages_infos` â† `context_extractor.messages_infos`
  - `decision_result` â† `decision_engine.decision_result`

## ğŸš€ å¿«é€Ÿå¼€å§‹
- éƒ¨ç½²å„Pythonæ¨¡å—åˆ°å¯¹åº”èŠ‚ç‚¹ï¼Œç¡®ä¿è¾“å…¥/è¾“å‡ºé”®åä¸€è‡´
- LLMèŠ‚ç‚¹é€‰æ‹©å¯¹åº”çš„System/Useræç¤ºè¯æ¨¡æ¿ï¼Œå¹¶å®Œæˆå˜é‡æ˜ å°„
- ä½¿ç”¨`test_cases/`ä¸­çš„æ•°æ®è¿›è¡Œç«¯åˆ°ç«¯éªŒè¯

## ğŸ“Š è¾“å‡ºç»“æœæ ¼å¼
è¯¦è§å„æ¨¡å—ä¸æç¤ºè¯ä¸­çš„JSONç»“æ„çº¦æŸã€‚